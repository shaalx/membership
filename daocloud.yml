image: daocloud/ci-golang:1.4

services:
    - mongodb

env:
    - GOPATH /gpath

install:
    - echo "This is an install segment"
    - sudo apt-get -y install curl
    - sudo apt-get -y install bzr

before_script:
    - export GOPATH=/gpath
    - mkdir -p /gpath/src/github.com/shaalx/membership /gpath/bin /gpath/pkg
    # - git clone --recursive git://github.com/shaalx/membership.git $GOPATH/src/github.com/shaalx/membership
    - git clone https://github.com/shaalx/membership.git $GOPATH/src/github.com/shaalx/membership
    - go get github.com/shaalx/membership
    - cd $GOPATH/src/github.com/shaalx/membership; git checkout mem;ls ; go install
    - ls;pwd
script:
    - echo "This is an script segment"
    - ping -c 2 mongodb
    - membership &
    - curl http://localhost/dbIndex